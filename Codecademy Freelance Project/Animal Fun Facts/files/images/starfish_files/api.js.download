extole.define("https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=127/common/api.js","https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=127/common/ExtoleError.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=127/common/collection.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=127/common/logger.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=127/common/ajax.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=127/common/Timer.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=127/common/client/program.js https://origin.xtlo.net/type=core:clientId=21243602:coreAssetsVersion=127/common/client/token-store.js".split(" "),
function(p,h,m,n,t,q,u){function r(){var d=this,g,e,h,l,c;this.withRequestSummary=function(a){l=a;return d};this.withResponseSummary=function(a){c=a;return d};this.withStatusCode=function(a){h=a;return d};this.withMessage=function(a){e=a;return d};this.asDebug=function(){g="debug";return d};this.asInfo=function(){g="info";return d};this.asWarn=function(){g="warn";return d};this.asError=function(){g="error";return d};this.log=function(){if(!l.url.match(m.LOGGING_ENDPOINT)){var a=[];h&&a.push("Status "+
h);e&&a.push(e);m[g](a.join(" "),{request:l,response:c})}}}var v=/^\/api\/v\d\//,w=q.getProgramDomain();return new function(){function d(c,a,b){e("get",c,null,a,b)}function g(c,a,b){e("delete",c,null,a,b)}function e(c,a,b,k,d){k=k||function(){};d=d||{};a=q.getProtocol()+w+m(a);var f=h.merge({"content-type":"application/json","x-extole-app":"javascript_sdk"},d.headers);f=Object.keys(f).reduce(function(a,b){a[b.toLowerCase()]=f[b];return a},{});d.noAuthorizationHeader||(f.authorization=u.get());b="multipart/form-data"===
f["content-type"]?n.convertToMultipartFormData(f,b):"application/x-www-form-urlencoded"===f["content-type"]||d.convertToFormUrlEncoded?n.convertToFormUrlEncoded(f,b):h.merge({},b);n({timeout:2E4,url:a,type:c,complete:function(a){a=a||null;var b=null;if(a)try{a=JSON.parse(a)}catch(x){b=new p("Couldn't parse as JSON response from request, response: '"+a+"'"),a=null}k&&k(b,a);a=h.merge({},a);a.timestamp=String((new Date).getTime());(new r).withRequestSummary(e).withResponseSummary(a).withMessage("Completed api request").asDebug().log()},
error:function(a,b){try{var c=JSON.parse(this.response)}catch(y){c={statusText:this.statusText,status:b}}k&&k(c);a=h.merge({},c);a.timestamp=String((new Date).getTime());a=(new r).withRequestSummary(e).withResponseSummary(a);b=String(b||c.http_status_code);"4"===b[0]?a.asInfo().withMessage("Failed api request").withStatusCode(b).log():a.asError().withMessage("Failed api request").withStatusCode(b).log()},data:b,headers:f,xhrFields:{withCredentials:!0}});var e={url:a,type:c,headers:f,data:b,timestamp:String((new Date).getTime())}}
function m(c){return c.match(v)?c:"/api/v4"+c}var l=!1;this.poll=function(c,a,b){function k(){var e=f.getElapsedTime();b.headers=h.merge({"X-Extole-Polling-Time":e},b.headers);d(c,function(b,c){if(l)b=new p("poll cancelled","cancelled");else if(g&&e>=g)b=new p("poll timed out after "+e+"ms","timed_out");else if(n(b,c)){setTimeout(k,m||300);return}a(b||c.error,c)},b)}function e(a,b){return a?!1:b&&"PENDING"===b.status}l=!1;a=a||function(){};b=b||{};var f=(new t).start(),g=b.pollTimeout||2E4,m=b.pollInterval||
300,n=b.retryCondition||e;k()};this.cancel=function(){l=!0};this.get=d;this.post=function(c,a,b,d){e("post",c,a,b,d)};this.put=function(c,a,b,d){e("put",c,a,b,d)};this.delete=this.del=g}});